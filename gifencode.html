<html><head>
    <script src="bits.js"></script>
    <script src="bytestream.js"></script>
    <script src="gif.js"></script>
    <script src="lzw.js"></script>
    <script>
      var toBytes = function(string) {
        var result = [];
        for(var i = 0; i < string.length; i++) {
          result.push(String.fromCharCode(string.charCodeAt(i) & 0xFF));
        }
        return result.join("");
      };
      var octetsToString = function(octets) {
        var result = [];
        for(var i = 0; i < octets.length; i++) {
          result.push(String.fromCharCode(octets[i] & 0xFF));
        }
        return result.join(""); 
      };
      /*
      var getFile = function(fname) {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", fname, false);
        xhr.overrideMimeType('text/plain; charset=x-user-defined'); 
        xhr.send();
        return xhr.responseText;
      };
      */
        var asHex = function(s) {
        var result = [];
        for(var i = 0; i <s.length; i++)
          result.push(s.charCodeAt(i).toString(16));
          //result.push((s.charCodeAt(i) & 0xFF).toString(16));
        return result
      }
      var test = function() {
        var octets = [0, 1, 0, 2, 0, 3, 1, 2, 0];
        var str = octetsToString(octets);
        var dd = new ImageDecoder(2,0);
        var codes = dd.generateCodes(new ByteStream(str));
        var octets = dd.codesToOctets(codes);
        var encodedString = octetsToString(octets);
        console.log(asHex(str));
        console.log(codes);
        console.log(octets);
        encodedString = String.fromCharCode(encodedString.length) + encodedString;
        console.log(asHex(encodedString));
        var dd = new ImageDecoder(2,1);
        var testDecode = dd.decode(new ByteStream(encodedString));
        console.log(asHex(testDecode));
        /*
        gifdata = getFile("./spacer.gif");
        console.log(gifdata);
        gifobj = decodeGif(gifdata);
        console.log(gifobj);
        */
      };

      test();
    </script>
  </head>
</html>
